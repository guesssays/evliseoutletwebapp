/* === styles.css (полная обновлённая версия) === */

/* Палитра и базовые переменные */
:root{
  --c-01:#292526; --c-02:#787676; --c-03:#A3A1A2; --c-04:#F2F2F2; --c-05:#121111;
  --bg:#ffffff; --text:#121111; --muted:#787676; --paper:#ffffff; --stroke:#ececec;
  --radius:22px; --r-sm:14px; --shadow:0 8px 24px rgba(0,0,0,.08);
  --tabbar-h:92px;                      /* ↑ запас под новый таббар */
  --safe: env(safe-area-inset-bottom, 0px);
  --toastTop:16px;
}

*{ box-sizing:border-box; }
html,body{ height:100% }
body{
  margin:0; background:var(--bg); color:var(--text);
  font:16px/1.5 "Encode Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  padding-bottom:calc(var(--tabbar-h) + var(--safe) + 24px); /* место под таббар/CTA */
}

/* Lucide безопасные дефолты */
.lucide, [data-lucide]{ stroke:currentColor; fill:none }

/* ===== ШАПКА ===== */
.app-header{
  position:sticky; top:0; z-index:30;
  backdrop-filter:saturate(1.2) blur(6px);
  background:linear-gradient(180deg, rgba(255,255,255,.92) 0%, rgba(255,255,255,.82) 100%);
  padding:14px 18px 10px;
  display:flex; justify-content:space-between; align-items:center; gap:10px;
  border-bottom:1px solid var(--stroke);
}

/* Брендинг в шапке */
.brand{ display:flex; align-items:center; gap:10px; }
.app-title{
  font-weight:800; font-size:22px; letter-spacing:.8px; text-transform:uppercase;
}

/* Кнопка уведомлений в шапке */
.icon-btn, .square-btn{
  display:inline-grid; place-items:center;
  width:44px; height:44px; border-radius:14px;
  border:1px solid var(--stroke); background:#f6f6f6; color:var(--text)
}
.icon-btn i, .square-btn i{ width:22px;height:22px }
.notif-btn{ position:relative; }
.notif-btn .lucide{ width:22px; height:22px; }

/* Бейдж уведомлений в шапке */
#notifBadge.badge{
  position:absolute; right:-6px; top:-6px;
  background:#ff5966; color:#fff;
  font-size:11px; line-height:1;
  border-radius:999px; padding:3px 6px;
  box-shadow:0 2px 10px rgba(0,0,0,.18);
}

/* Кнопки-pill (и <a>, и <button>) */
.pill{
  display:inline-flex; gap:8px; align-items:center;
  border-radius:999px; border:1px solid var(--stroke);
  padding:10px 14px; font-weight:700; background:#fff;
  text-decoration:none; color:var(--text);
}
.pill.small{ padding:8px 12px }
.pill.primary{ background:#121111; color:#fff; border-color:#121111 }
.pill i{ width:18px; height:18px }
.pill:link, .pill:visited{ text-decoration:none; color:var(--text); }
.pill:hover{ background:#f8f8f8; }
.pill:focus-visible{ outline:2px solid #121111; outline-offset:3px; }

/* ===== ПОИСК/ФИЛЬТРЫ/ЧИПЫ ===== */
.section{ padding:0 18px; margin:10px 0 }
.section-search{ display:flex; gap:10px; align-items:center }
.search-wrap{ position:relative; flex:1 }
.search-ico{
  position:absolute; left:12px; top:50%; transform:translateY(-50%);
  width:20px; height:20px; color:#a0a0a0
}
.search{
  width:100%; height:48px; border-radius:16px; padding:0 14px 0 38px;
  border:1px solid var(--stroke); background:#fff; font:600 16px "Encode Sans";
}
.chipbar{ display:flex; gap:10px; overflow:auto; padding-bottom:6px }
.chip{
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 14px; border:1px solid var(--stroke); border-radius:16px; background:#fff;
  font-weight:700; color:var(--text); white-space:nowrap;
}
.chip.active{ background:#121111; color:#fff; border-color:#121111 }
.chip i{ width:18px; height:18px }
.chip-mini{ padding:8px 12px; font-size:13px }

/* ===== ГЛАВНЫЙ КОНТЕНТ / КАРТОЧКИ ===== */
.view{ padding:0 18px 24px }
.grid{ display:grid; grid-template-columns:1fr 1fr; gap:14px }

.card{
  display:flex; flex-direction:column; text-decoration:none; color:inherit;
  background:#fff; border-radius:20px; overflow:hidden
}
.card-img{ position:relative; aspect-ratio:3/4; border-radius:22px; overflow:hidden }
.card-img img{ width:100%; height:100%; object-fit:cover; display:block }

/* Кнопка избранного на карточке */
.card-img .fav{
  position:absolute; right:10px; top:10px; width:42px; height:42px;
  border-radius:50%; border:none; background:#fff; box-shadow:var(--shadow);
  display:grid; place-items:center; cursor:pointer;
}
.card-img .fav svg{ width:22px; height:22px; }
.card-img .fav.active .lucide-heart{
  color:#ff4d5a; fill:currentColor; stroke:none; transition:transform .12s ease;
}
.card-img .fav.active:active .lucide-heart{ transform:scale(0.92); }

.card-body{ padding:10px 6px }
.card-body .title{ font-weight:800; font-size:20px; margin-bottom:2px }
.card-body .subtitle{ color:var(--muted) }
.price-row{ display:flex; justify-content:space-between; align-items:center; margin-top:10px }
.price{ font-weight:800; font-size:20px }

/* ===== ПРОДУКТ ===== */
.product{ display:block }

/* Галерея товара */
.gallery{ display:grid; gap:10px; }
.gallery-main{ position:relative; border-radius:24px; overflow:hidden; background:#f6f6f6; }
.gallery-main img{ width:100%; height:auto; display:block; }
.thumbs{ display:flex; gap:10px; overflow:auto; -webkit-overflow-scrolling:touch; padding-bottom:2px; }
.thumb{
  flex:0 0 auto; width:72px; height:72px; border-radius:12px; padding:0;
  border:2px solid transparent; overflow:hidden; background:#fff; cursor:pointer;
}
.thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.thumb.active{ border-color:#121111; }

/* Реальные фото */
.real-photos{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.real-photo{ border-radius:16px; overflow:hidden; background:#f6f6f6; }
.real-photo img{ width:100%; height:auto; display:block; }

.p-hero{ position:relative; margin:0 18px; border-radius:24px; overflow:hidden } /* оставлено для совместимости, если используется */
.hero-btn{
  position:absolute; top:12px; width:48px; height:48px;
  border-radius:999px; display:grid; place-items:center; background:#fff; border:none; box-shadow:var(--shadow)
}
.hero-back{ left:12px } .hero-fav{ right:12px }
.hero-fav.active .lucide-heart{ color:#ff4d5a; fill:currentColor; stroke:none }

.p-body{ padding:16px 18px }
.p-title{ font-size:34px; font-weight:800; line-height:1.15; margin:8px 0 6px }
.p-desc{ color:var(--muted) }
.qty-row{ display:flex; gap:10px; align-items:center }
.qty-ctrl{ display:flex; align-items:center; gap:10px }
.ctrl{ width:44px; height:44px; border:1px solid var(--stroke); border-radius:14px; display:grid; place-items:center; background:#fff }

.p-options{ display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-top:12px }
.opt-title{ font-weight:800; margin:10px 0 }
.sizes{ display:flex; gap:10px; flex-wrap:wrap }
.size{ padding:10px 14px; border:1px solid var(--stroke); border-radius:999px; background:#fff; font-weight:700; cursor:pointer }
.size.active{ background:#121111; color:#fff; border-color:#121111 }
.colors{ display:flex; gap:12px; align-items:center; flex-wrap:wrap }
.sw{ width:34px; height:34px; border-radius:50%; border:2px solid #fff; outline:1px solid #e5e5e5; cursor:pointer }
.sw.active{ outline-color:#121111 }
.specs{ margin-top:10px; color:var(--muted) }

.table-wrap{ overflow:auto; -webkit-overflow-scrolling:touch; margin-top:10px; border:1px solid var(--stroke); border-radius:16px }
.size-table{ width:100%; border-collapse:separate; border-spacing:0 }
.size-table th, .size-table td{ padding:10px 12px; white-space:nowrap; font-size:14px }
.size-table thead th{ background:#f8f8f8; text-align:left; font-weight:800 }
.size-table tbody tr:not(:last-child) td{ border-bottom:1px solid var(--stroke) }

/* Нижний CTA */
.cta{ position:sticky; bottom:calc(var(--tabbar-h) + var(--safe) - 6px); padding:12px 18px; z-index:3 }
.btn{
  width:100%; height:64px; border:none; border-radius:999px;
  display:flex; align-items:center; justify-content:center; gap:10px; cursor:pointer;
  font-weight:800; font-size:18px; background:#121111; color:#fff;
  transition:transform .08s ease, opacity .15s ease, box-shadow .2s ease; box-shadow:0 8px 24px rgba(0,0,0,.08);
}
.btn i{ width:22px; height:22px }
.btn:active{ transform:translateY(1px) }
.btn:hover{ box-shadow:0 10px 28px rgba(0,0,0,.12) }
.btn:focus-visible{ outline:2px solid #121111; outline-offset:3px; }
.btn:disabled{ opacity:.6; cursor:not-allowed; box-shadow:none; }

/* ===== КОРЗИНА/ЧЕКАУТ ===== */
.section-title{ font-size:24px; font-weight:800; margin:10px 18px }
.checkout{ padding:0 18px calc(var(--tabbar-h) + var(--safe) + 24px); display:grid; gap:14px }
.cart-row{
  display:grid; grid-template-columns:72px 1fr auto; gap:14px; align-items:center;
  padding:12px 0; border-bottom:1px solid var(--stroke)
}
.cart-img{ width:72px; height:72px; border-radius:16px; overflow:hidden }
.cart-img img{ width:100%; height:100%; object-fit:cover }
.cart-title{ font-weight:800; font-size:18px }
.cart-sub{ color:var(--muted); font-size:14px; margin-top:2px }
.cart-price{ font-weight:800 }
.qty-mini{ display:flex; align-items:center; gap:10px }
.qty-mini .ctrl{ width:36px; height:36px; border-radius:12px }
.shipping{ margin:4px 0 12px }
.address-row{ display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap }
.payline{ display:grid; gap:10px; border-top:1px solid var(--stroke); padding:12px 0 }
.payrow{ display:flex; justify-content:space-between; align-items:center }
.paybtn{ position:sticky; bottom:calc(var(--tabbar-h) + var(--safe)); padding:0 18px 12px; z-index:3 }

/* ===== АККАУНТ/АДРЕСА ===== */
.account-card{
  display:flex; gap:12px; align-items:center; background:#fff;
  padding:12px; border:1px solid var(--stroke); border-radius:16px
}
.account-card .avatar{
  width:44px; height:44px; border-radius:50%; background:#121111; color:#fff;
  display:grid; place-items:center; font-weight:800
}
.account-card .info .name{ font-weight:800; }
.menu{ display:grid; gap:8px; margin-top:12px }
.menu-item{
  display:flex; align-items:center; gap:12px; padding:12px;
  border:1px solid var(--stroke); border-radius:14px; background:#fff; text-decoration:none; color:inherit
}
.menu-item i{ width:20px; height:20px }
.menu-item .chev{ margin-left:auto; opacity:.5 }
.addr-list{ display:grid; gap:8px; margin-top:10px }
.addr{
  display:flex; gap:12px; align-items:flex-start; padding:12px;
  border:1px solid var(--stroke); border-radius:14px; background:#fff
}
.addr input{ margin-top:6px }
.addr-title{ font-weight:800 }
.addr-sub{ color:var(--muted) }
.addr-actions{ display:flex; gap:10px; margin-top:12px }

/* ===== УВЕДОМЛЕНИЯ ===== */
.notes{ padding:0 18px calc(var(--tabbar-h) + var(--safe) + 24px); display:grid; gap:10px; }
.note{
  display:grid; grid-template-columns:auto 1fr auto; gap:12px;
  border:1px solid var(--stroke); border-radius:16px; background:#fff; padding:12px;
}
.note i{ width:20px; height:20px; color:#787676 }
.note .note-title{ font-weight:800; }
.note .note-sub{ color:var(--muted); font-size:14px; margin-top:2px; }
.note .time{ color:#A3A1A2; font-size:12px; white-space:nowrap; align-self:start; }
.notes-empty{
  margin:20px 18px; padding:18px; border:1px dashed var(--stroke);
  border-radius:16px; color:var(--muted);
}

/* ===== ТАББАР (устойчивый фон + капсульный актив) ===== */
.tabbar{
  position:fixed; left:0; right:0; bottom:0; z-index:50;
  padding-bottom:max(8px, var(--safe));
  background:transparent;
  pointer-events:none;                 /* клики только по внутреннему блоку */
}
.tabbar-inner{
  pointer-events:auto;
  margin:0 18px; height:76px; border-radius:28px;
  background:#1f1e1e; box-shadow:0 10px 40px rgba(0,0,0,.18);
  display:flex; align-items:center; justify-content:space-around; gap:6px; padding:0 8px;
}
.tab{
  position:relative; min-width:64px; height:52px; padding:6px 12px; border-radius:16px;
  color:#fff; text-decoration:none;
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
  font-weight:700; opacity:.9; transition:background .18s ease, opacity .18s ease, transform .08s ease;
}
.tab i{ width:26px; height:26px }
.tab span{ font-size:12px; line-height:1; }
.tab:hover{ opacity:1; }
.tab:active{ transform:translateY(1px); }
.tab.active{ background:rgba(255,255,255,.14); opacity:1; }

.badge-wrap{ position:relative }
.badge{
  position:absolute; right:2px; top:-2px;
  background:#ff5966; color:#fff; font-size:11px; line-height:1;
  border-radius:999px; padding:3px 6px; box-shadow:0 2px 10px rgba(0,0,0,.18);
}
.dot{ display:none !important; } /* прежний индикатор — отключён */

/* ===== МОДАЛКИ / ТОСТЫ ===== */
.modal{ position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.35) }
.modal.show{ display:grid }
.modal-dialog{ width:min(92vw,560px); background:#fff; border-radius:18px; overflow:hidden; box-shadow:var(--shadow) }
.modal-head{ display:flex; align-items:center; justify-content:space-between; padding:12px 14px; border-bottom:1px solid var(--stroke); font-weight:800 }
.modal-body{ padding:14px }
.modal-actions{ display:flex; gap:8px; padding:12px 14px; border-top:1px solid var(--stroke); justify-content:flex-end }

.toast-wrap{ position:fixed; top:var(--toastTop); right:16px; display:grid; gap:8px; z-index:70 }
.toast{
  background:#121111; color:#fff; padding:10px 12px; border-radius:12px;
  box-shadow:var(--shadow); transition:opacity .25s ease
}

/* ===== АДАПТИВ ===== */
@media (max-width: 380px){
  .grid{ grid-template-columns:1fr; }
  .p-title{ font-size:28px }
  .btn{ height:58px; font-size:16px }
  .thumb{ width:64px; height:64px }
  .real-photos{ grid-template-columns:1fr 1fr; }
  .tabbar-inner{ height:72px; }
  .tab{ height:50px; }
}
/* === CTA-режим таббара === */
/* кнопка уже тянется на 100% через inline-style; оставим базовую высоту контейнера */
.tabbar .btn { height:64px; }

/* === Overlay для просмотра фото === */
.zoom-overlay{
  position:fixed; inset:0; background:rgba(0,0,0,.85);
  display:none; z-index:1000;
}
.zoom-overlay.show{ display:block; }
.zoom-stage{
  position:absolute; inset:0; display:grid; place-items:center;
}
#zoomImg{
  max-width:96vw; max-height:92vh; will-change:transform;
  touch-action:none; /* чтобы жесты работали предсказуемо */
}
.zoom-close{
  position:absolute; right:14px; top:14px;
  width:44px; height:44px; border:none; border-radius:12px;
  display:grid; place-items:center; background:#fff; color:#121111;
  box-shadow:0 8px 24px rgba(0,0,0,.2); cursor:pointer;
}
.zoom-close i{ width:22px; height:22px }
